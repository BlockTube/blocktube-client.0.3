<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/ipfs-upload/ipfs-upload.html">
<link rel="import" href="../bt-style/bt-style.html">

<dom-module id="bt-listitem">
  <!-- <template>
    <style is="custom-style" include="shared-styles"></style>

    <style>
      :host {
        display: block;
      }

      .total {
        background-color: rgba(0,0,0,0.02);
        /* This value changes in queries */
        width: 262px;
        margin: 0px 6px 26px 6px;
        border-bottom: 2px solid rgba(0,0,0,0.025);
      }



      h4 {
        @apply(--bt-font-h4);
        margin: 0px;   
      }

      h5 {
        @apply(--bt-font-h5);
        margin: 0px;
      }


      p {
        @apply(--bt-font-body);
        margin: 0px;
      }




      .container {
        width: 100%;
        @apply(--layout-horizontal);
        @apply(--layout-start);
        @apply(--layout-start-justified);
      }




      .uploaderinfo {
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
        height: 60px;
        width: 50px;
      }

      .uploader {
        @apply(--layout-horizontal);
        @apply(--layout-center);
        @apply(--layout-start-justified);
        width: 100%;
        color: var(--bt-green);
      }

      .uploader p {
        text-overflow: ellipsis;
        overflow: hidden; 
        -webkit-line-clamp: 1;
        -webkit-box-orient: vertical;
        font-size: 11px;
      }

      .uploader a {
       text-decoration: none;
        color: var(--bt-green);
      }
      .uploader a:hover {
       text-decoration: underline;
      }

      .uploaderavatar {
        width: 30px;
        height: 30px;
        background-color: black;
        border-radius: 50px;
        overflow:hidden;
      }

      .uploaderavatar img {
        width: 100%;
        height: 100%;
      }


      .videoinfo {
        width: 202px;
        box-sizing: border-box;
        padding: 15px 15px 10px 0px;
        @apply(--layout-vertical);
        @apply(--layout-start);
        @apply(--layout-start-justified);
      }


      .title {
        width: 100%;
        margin: 0px;
      }


      .title h4 {
        @apply(--montserrat-bold);
        color: var(--bt-dark);
        font-size: 16px;
        margin: 0px 0px 2px 0px;   
      }

      .title h4:hover {
        cursor: pointer;
        text-decoration: underline;
      }


      .descr p {
        font-size: 12.5px;
        line-height: 14px;
        margin: 12px 0px 0px 0px;
        color: var(--bt-grey5); 
        height: 30px;
          text-overflow: ellipsis;
        overflow: hidden; 
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
      }


    
      .flexchild {
        @apply(--layout-flex);
      }
    
      .gris {
        color: --google-grey-100;
      }
    
      .actionbuttons {
        @apply(--layout-horizontal);
      }

      .thumbnail {
        width: 100%;
        height: 130px;
      }
      .thumbnail:hover {
        cursor: pointer;
      }


      #duration {
        background-color: black;
        color: white;
        height: 20px;
        font-weight: bold;
        padding:5px 12px 5px 12px;
/*        position: relative;*/
/*        top: 190px;*/
        max-width: 60px;
        text-align: right;
        @apply(--horizontal-layout);
        @apply(--horizontal-center);
       }

      .tags {
        color: var(--bt-green);
      }

      .tags h5 {
        font-size: 10px;
      }


      /* THESE ARE ALL NON-STANDARD QUERIES FOR THE DIFFERENT VIDEO SIZES */
      @media all and (min-width: 0) and (max-width: 360px) and (orientation: portrait) {    

        .total {
          background-color: rgba(0,0,0,0.02);
          width: 92vw;
          margin: 0px 0px 10px 0px;
          border-bottom: 2px solid rgba(0,0,0,0.025);
        }
        .thumbnail {
          width: 100%;
          height: 146px;
        }
        .descr p {
          width: 100%;
          @apply(--bt-font-body);
          margin: 8px 0px 0px 0px;
          white-space: nowrap;
          text-overflow: ellipsis;
          overflow: hidden; 
          -webkit-line-clamp: 1;
          -webkit-box-orient: vertical;
        }

/*        .uploaderinfo {
          height: 70px;
          width: 70px;
        }


        .uploaderavatar {
          width: 35px;
          height: 35px;
        }*/

      }

      @media all and (min-width: 361px) and (max-width: 609px) and (orientation: portrait) {
      }

      @media all and (min-width: 610px) and (max-width: 760px) and (orientation: portrait) {
      }

      @media all and (min-width: 761px) {
      }

    </style>

    <bt-clipdata web3="[[web3]]" contract="{{contract}}" clipdata="{{clipdata}}"></bt-clipdata>

    <div class="total">
      <div
      on-tap="_godetail" 
      class="thumbnail"
      id="thumb"
      style="background: url({{thumbnail}}) no-repeat center; background-size: cover;"></div>

      <div  class="container">
        <div class="uploaderinfo">
          <div class="uploaderavatar">
          <img src="https://pbs.twimg.com/profile_images/503980000958103552/7YzFr8Ur_400x400.jpeg">
          </div>
        </div>
        <div class="videoinfo">
          <div class="title">
            <h4 on-tap="_godetail">{{clipdata.name}}</h4>
            <div class="uploader"><p>by <a href="">Vladimir Dobrijenko</a></p></div>

            <div  class="descr"><p>{{clipdata.description}}</p></div>
          </div>
          <div class="tags">
            <h5>{{clipdata.tags}}</h5>
          </div>
        </div>
      </div>
    </div>

  </template> -->






<template>
    <style is="custom-style" include="shared-styles"></style>

    <style>
      :host {
        display: block;
      }

      .total {
        background-color: rgba(0,0,0,0.02);
        /* This value changes in queries */
        width: 262px;
        margin: 0px 6px 26px 6px;
        border-bottom: 2px solid rgba(0,0,0,0.025);
      }



      h4 {
        @apply(--bt-font-h4);
        margin: 0px;   
      }

      h5 {
        @apply(--bt-font-h5);
        margin: 0px;
      }


      p {
        @apply(--bt-font-body);
        margin: 0px;
      }




      .container {
        width: 100%;
        @apply(--layout-vertical);
        @apply(--layout-start);
        @apply(--layout-start-justified);
      }

      .seperation {
        height: 2px;
        background-color: rgba(0,0,0,0.025);
        width: 100%;
      }

      .upload {
        width: 100%;
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
        /*@apply(--layout-end-justified);*/
        margin: 0px 0px 0px 0px;
        box-sizing: border-box;
        padding: 10px 15px 10px 15px;
      }


      .avatar {
        width: 25px;
        height: 25px;
        background-color: var(--bt-green);
        border-radius: 50%;
        overflow:hidden;
      }

      .avatar img {
        width: 100%;
        height: 100%;
      }

      .uploaderinfo {
        width: 100%;
        @apply(--layout-flex);
        color: var(--bt-green);
        text-align: left;
        box-sizing: border-box;
        padding: 0px 10px 0px 10px;

      }

      .uploaderinfo p {
        text-overflow: ellipsis;
        overflow: hidden; 
        -webkit-line-clamp: 1;
        -webkit-box-orient: vertical;
        font-size: 11px;
      }

      .uploaderinfo a {
       text-decoration: none;
       @apply(--lato-bold);
        color: var(--bt-green);
      }
      .uploaderinfo a:hover {
       text-decoration: underline;
      }







      .videoinfo {
        width: 100%;
        box-sizing: border-box;
        padding: 15px;
        @apply(--layout-vertical);
        @apply(--layout-start);
        @apply(--layout-start-justified);
      }


      .title {
        width: 100%;
        margin: 0px;
      }


      .title h4 {
        @apply(--montserrat-bold);
        color: var(--bt-dark);
        font-size: 16px;
        margin: 0px 0px 2px 0px;   
      }

      .title h4:hover {
        cursor: pointer;
        text-decoration: underline;
      }


      .descr p {
        font-size: 12.5px;
        line-height: 14px;
        margin: 4px 0px 0px 0px;
        color: #595959; 
        height: 25px;
          text-overflow: ellipsis;
        overflow: hidden; 
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
      }

      .tips p {
        @apply(--montserrat-reg);
        color: var(--bt-yellow);
        font-size: 12px;
/*        background-color: var(--bt-yellow); 
        color: var(--bt-black);
        box-sizing: border-box;
        padding: 5px;*/
        margin: 10px 0px 5px 0px;
      }

      .bold {
        @apply(--montserrat-bold);
      }


    
      .flexchild {
        @apply(--layout-flex);
      }
    
      .gris {
        color: --google-grey-100;
      }
    
      .actionbuttons {
        @apply(--layout-horizontal);
      }

      .thumbnail {
        width: 100%;
        height: 130px;
      }
      .thumbnail:hover {
        cursor: pointer;
      }


      #duration {
        background-color: black;
        color: white;
        height: 20px;
        font-weight: bold;
        padding:5px 12px 5px 12px;
/*        position: relative;*/
/*        top: 190px;*/
        max-width: 60px;
        text-align: right;
        @apply(--horizontal-layout);
        @apply(--horizontal-center);
       }

      .tags {
        color: var(--bt-green);
      }

      .tags h5 {
        font-size: 10px;
      }

      .eyeballstotal {
        position: absolute;
        width: inherit;
        @apply(--layout-horizontal);
        @apply(--layout-center);
        @apply(--layout-end-justified);
        box-sizing: border-box;
        padding: 10px;      
      }

      .eyeballs {
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
        min-width: 32px;
        height: 32px;
        border-radius: 17.5px;
/*        border: 1px solid rgba(217,184,54,0.5);*/
        background-color: rgba(217,184,54,0.35);
        box-sizing: border-box;
        padding: 8px;
      }

      .eyeballs p {
        @apply(--montserrat-bold);
        color: var(--bt-yellow);
        font-size: 16px;
      }

      .btcoin {
        font-size: 11px;
      }

      /* THESE ARE ALL NON-STANDARD QUERIES FOR THE DIFFERENT VIDEO SIZES */
      @media all and (min-width: 0) and (max-width: 360px) and (orientation: portrait) {    

        .total {
          background-color: rgba(0,0,0,0.02);
          width: 92vw;
          margin: 0px 0px 10px 0px;
          border-bottom: 2px solid rgba(0,0,0,0.025);
        }
        .thumbnail {
          width: 100%;
          height: 146px;
        }


        .descr p {
          width: 100%;
          @apply(--bt-font-body);
          margin: 8px 0px 0px 0px;
          white-space: nowrap;
          text-overflow: ellipsis;
          overflow: hidden; 
          -webkit-line-clamp: 1;
          -webkit-box-orient: vertical;
        }

      }





      @media all and (min-width: 361px) and (max-width: 609px) and (orientation: portrait) {
      }

      @media all and (min-width: 610px) and (max-width: 760px) and (orientation: portrait) {
      }

      @media all and (min-width: 761px) {
      }

    </style>

    <bt-clipdata web3="[[web3]]" contract="{{contract}}" clipdata="{{clipdata}}"></bt-clipdata>

    <div class="total">
      <div class="eyeballstotal">
<!--         <div class="eyeballstriangle">
          <img src="../../images/triangle-01.svg">
        </div> -->
        <div class="eyeballs">
          <p>1 <span class="btcoin">ß</span></p>
        </div>
      </div>

      <div
      on-tap="_godetail" 
      class="thumbnail"
      id="thumb"
      style="background: url({{thumbnail}}) no-repeat center; background-size: cover;"></div>



      <div  class="container">
        <div class="videoinfo">
          <div class="title">
            <h4 on-tap="_godetail">{{clipdata.name}}</h4>
            <div class="descr"><p>{{clipdata.description}}</p></div>
            <!-- <div class="tips"><p><span class="bold">0 ß</span></p></div> -->
          </div>
          <div class="tags">
            <h5>{{clipdata.tags}}</h5>
          </div>
        </div>

        <div class="seperation"></div>
        <div class="upload">
          <div class="avatar">
            <img src="https://pbs.twimg.com/profile_images/503980000958103552/7YzFr8Ur_400x400.jpeg">
          </div> 
          <div class="uploaderinfo"><p>by <a href="">Vladimir Dobrijenko</a></p></div>
        </div>
      </div>

    </div>

  </template>










  <script>
    (function() {
      'use strict';
      
      Polymer({
        is: 'bt-listitem',

        listeners: {
          'tap': 'firelisttap',
      },

        properties: {
          clipdata: {
            type: Object,
            observer: '_clipdata'
          },
          itemcache: {
            type: Object,
            //observer: 'itemcacheloaded'            
          },
          web3: {
            type: Object,
            //observer: '_web3'
          },
          contract: {
            type: String,
            //observer: '_contract'
          },
          title: {
            type: String,
            //value: 'Loading ipfs',
            notify: true
          },
          description: {
            type: String,
            //value: 'Loading ipfs',
            notify: true
          },
          views: {
            type: Number,
            value: 1000
          },
          comments: {
            type: Number,
            value: 2
          },
          thumb: {
            type: String,
            value: ''
          },
          duration: {
            type: Number,
            value: 0
          },
          listitem: {
            type: Boolean,
            value: false
          },
          likebutton: {
          type: Boolean,
          observer: '_likebutton',
          value: false
        },


        },


        _clipdata: function() {

          console.log('clipdata=', this.clipdata);
          if (!this.clipdata.thumbnail) {
            this.thumbnail = this.ipfs_url + "QmVGxkXGnQMAduHU81Xgn2zLi2kgnvkXMUAWEanZ87nQx9";
          } else {
            if (this.clipdata.thumbnail.startsWith('data')) {
              // it's a dataURL
              this.thumbnail = this.clipdata.thumbnail;
            } else {
              // it's an IPFS hash
              this.thumbnail = this.ipfs_url + this.clipdata.thumbnail;
            }
          }
          //debugger;
          //  if (!this.clipdata)
          //  https://ipfs.pics/QmVGxkXGnQMAduHU81Xgn2zLi2kgnvkXMUAWEanZ87nQx9
        },

        ready: function(){          
          var web3el = document.querySelector('#web3wallet');
          this.web3 = web3el.web3;

         if (!this.ipfs_url) {
            this.ipfs_url = new Polymer.IronMetaQuery({
              key: 'ipfs_url'
            }).value;
          }

        },

        hitMe: function(){
          //this.fire('go', { msg: "/clip/hash1" });
          //location ="/clip/hash1";

          //Excess.RouteManager.transitionTo('/clip/'+this.hash);

//          page('/clip/'+this.hash);
        },

        _likebutton: function(){
          //console.log('Like? ', this.likebutton);
        },

        _godetail: function(){
          Excess.RouteManager.transitionTo('/clip/' + this.contract);
        },

      });
    })();
  </script>

</dom-module>