
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-icons/av-icons.html">
<link rel="import" href="../../bower_components/iron-icons/hardware-icons.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">
<!-- <script src="../../bower_components/VideoSub/videosub.js"></script>
 -->

<script>
//  videojs.options.flash.swf = "http://example.com/path/to/video-js.swf"
</script>

<dom-module id="bt-clip">
  <template>
    <style>
      :host {
        display: block;
      }
      video {
      /*  HIER NOG NIET NAAR ZIEN!*/
        }

        .wide {
          width: 100%; 
        }

        #playpause {
          width: 80px;
          height: 80px;
        }

        .soundslider {
          width: 100px;
        }

        .controls {
/*          background-color: red;
*/        }

        .overlay {
          
          max-height: 300px;
        }

        paper-slider {
          --paper-slider-active-color: var(--bt-orange);
          --paper-slider-secondary-color: var(--bt-orange);
          --paper-slider-knob-color: var(--bt-orange);
        }

    </style>


    <bt-clipdata web3="[[web3]]" contract="{{clipcontract}}" clipdata="{{clipdata}}"></bt-clipdata>

    <div class="vertical layout">

 <video id="videoplayer" class="video-js vjs-default-skin"
  controls autoplay="false"
  data-setup='{"example_option":true}'>
              <p class="vjs-no-js">
                To view this video please enable JavaScript, and consider upgrading to a web browser that
                <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
              </p>
            </video>
      <h1>{{clipdata.title}}</h1>      
      <h2>{{clipdata.description}}</h2>      

          </div>
        </template>
  <script>
  (function() {
    // 'use strict';

    Polymer({
      is: 'bt-clip',

      properties: {

        clipcontract: {
          type: String,
          //value: 'QmR8NyktETUYryjL3ZecAGJtSYPup9CJqihxyJVXcHuLBu',
          //notify: true,
          //observer: '_clipcontract'
        },
        clipdata : { 
          type: Object,
          observer: '_clipdata'
        },
        videourl: {
          type: String,
          notify: true
        },

        progresspercentage: {
          type: Number,
          value: 0
        }

      },

      // showOverlay: function() {
      //   //console.log('hit it!', Date.now());
      //   this.overlayvisible = true;
      //   this.resttime = this.timeout;
      //   this.overlay = document.querySelector('#overlay');
      //   this.overlay.hidden = false;
      // },

      // countdownOverlay: function() {
      //   if (!this.interval) {
      //     this.interval = setInterval(function() {
      //       this.resttime = this.resttime - 1;
      //       if (this.resttime <= 0) {
      //         this.toggleVisibility();
      //       }
      //     }.bind(this), 1000);
      //   }
      // },

      // toggleVisibility: function() {
      //   clearInterval(this.interval);
      //   this.interval = null;
      //   if (this.overlayvisible) {
      //     this.overlayvisible = false;
      //     this.overlay.hidden = true;
      //   } else {
      //     this.overlayvisible = true;
      //     this.overlay.hidden = false;
      //   }
      // },

      // attached: function() {
      //   this.init = true;
      //   this.mute = false;
      // },

      // enableplay: function() {
      //   this.$.playpause.disabled = false;
      //   this.$.vp.volume = this.volume / 200;
      // },

      // togglePlay: function() {
      //   if (this.playing) {
      //     this.playing = false;
      //     this.playicon = 'av:play-arrow';
      //     this.$.vp.pause();
      //   } else {
      //     this.playing = true;
      //     this.playicon = 'av:pause';
      //     this.$.vp.play();
      //   }
      // },

      // toggleOverlay: function() {
      //   console.log('hovering video', Date.now());
      // },

      close: function() {
        //this.fire('close');
        Excess.RouteManager.transitionTo('/home');
      },

      // _playing: function() {

      // },

      // _scrubtime: function() {
      //   if (this.init) {
      //     var newtime = this.$.vp.duration * this.scrubtime;
      //     console.log(newtime / 100);
      //     this.$.vp.currentTime = newtime / 100;
      //   }
      //   //this.$.vp.currentTime = newtime;
      // },

      // _progress: function() {
      //   var perplayed = this.$.vp.currentTime / this.$.vp.duration;
      //   //console.log(this.$.vp.currentTime, ' / ', this.$.vp.duration, ' ', perplayed * 100, '%');
      //   this.progresspercentage = perplayed * 100;

      // },

      // _volume: function() {
      //   console.log(this.volume);
      //   if (this.init) {
      //     this.$.vp.volume = this.volume / 200;
      //     this.prevvolume = this.volume;
      //     console.log(this.$.vp.volume);

      //     this.volumeicon = 'av:volume-down';

      //   }
      // },

      // toggleMute: function() {
      //   if (this.mute) {
      //     this.prevvolume = this.volume;
      //     this.volume = 0;
      //     this.mute = false;
      //     this.volumeicon = 'av:volume-off';
      //   } else {
      //     this.volume = this.prevvolume;
      //     this.mute = true;
      //   }
      // },


      _initipfs: function() {
        if (!this.ipfs_url) {
          this.ipfs_url = new Polymer.IronMetaQuery({
            key: 'ipfs_url'
          }).value;
        }
      },

      _clipdata: function() {

        this._initipfs();
        var self = this;

        setTimeout(function(){
          self.player = videojs(this.$.videoplayer, {}, function() {

            this.src(self.ipfs_url + self.clipdata.video);
  //          this.chromecast();
          });

self.player.chromecast();
      

//      console.log(self.player);
          }.bind(this),3000);

      },


      _clipcontract: function() {
      //  this.$.contractcache.name = 'itemcache-' + this.clipcontract;

        //        console.log('bt-clip got contract' , this.clipcontract);



      }
    });
  })();
  </script>
</dom-module>